# Data engineering infrastructure to process FSM data

## Overview
This project contains Terraform scripts to provision a data infrastructure on Azure. The scripts are designed to be run locally, using the Azure CLI for authentication.

The architecture comprises Databricks (Spark clusters, SQL Endpoint, and Unity Catalog), Azure Data Lake Gen 2, and Azure Key Vault. The file arrival trigger was implemented using Databricks jobs, which runs a pipeline that sets up the environment (creates and refreshes tables as needed) and processes all the data. All Databricks resources were implemented using the Terraform Databricks provider, with the exception of tables.

## Prerequisites
1. [Terraform](https://www.terraform.io/downloads.html) installed on your local machine.
2. [Azure CLI](https://docs.microsoft.com/en-us/cli/azure/install-azure-cli) installed on your local machine.
3. An active Azure subscription.

## Getting Started

### Authenticate with Azure CLI
Before running the Terraform scripts, you need to authenticate with Azure. Open a terminal and run:

```bash
az login
```

Follow the prompts in your browser to complete the authentication process.

### Clone the Repository
Clone this repository to your local machine:

```bash
git clone <repository-url>
```

Navigate to the directory containing the Terraform scripts:

```bash
cd <directory-name>
```

### Initialize Terraform
Initialize your Terraform workspace, which will download the provider and initialize it with the values provided in the terraform.tfvars file:

```bash
terraform init
```

### Plan the Deployment
Run the following command to create an execution plan and see what Terraform will do:

```bash
terraform plan
```

### Apply the Configuration
Apply the configuration to reach the desired state of the configuration, or the pre-determined set of actions generated by a terraform plan execution plan:

```bash
terraform apply
```
Confirm the apply with a yes.

### Acknowledgments
Please replace the terraform.auto.tfvars variables with your id and email and set your Azure subscription in the provider on providers.tf.
